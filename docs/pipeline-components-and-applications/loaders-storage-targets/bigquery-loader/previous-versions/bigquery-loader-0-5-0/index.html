<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-5-0/index">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="Snowplow Documentation" href="/opensearch.xml"><title data-rh="true">BigQuery Loader (0.5.x) | Snowplow Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.snowplow.io/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-5-0/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="BigQuery Loader (0.5.x) | Snowplow Documentation"><meta data-rh="true" name="description" content="Technical Architecture"><meta data-rh="true" property="og:description" content="Technical Architecture"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.snowplow.io/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-5-0/"><link data-rh="true" rel="alternate" href="https://docs.snowplow.io/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-5-0/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.snowplow.io/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-5-0/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://9HS3C2MKTH-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.c14a5ea9.css">
<link rel="preload" href="/assets/js/runtime~main.a25030c0.js" as="script">
<link rel="preload" href="/assets/js/main.cac1a3dd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="announcementBarContent_xLdY">ðŸ‘“ Participate in research that will shape the future of Snowplow Open Source! <a target="_blank" rel="noopener noreferrer" href="https://docs.google.com/forms/d/e/1FAIpQLSeZ1WIQO50N5bb6nIVb6CqIolkCrunimkQtMLpSU31wNKC6GQ/viewform">Apply here.</a></div><button type="button" class="clean-btn close announcementBarClose_gvF7" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/snowplow-logo.svg" alt="Snowplow Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/snowplow-logo.svg" alt="Snowplow Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a aria-current="page" class="navbar__item navbar__link nav-link__first customized_AOMy navbar__link--active" href="/docs/">Docs</a><a href="https://discourse.snowplow.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link undefined customized_AOMy">Discourse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/snowplow/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link undefined customized_AOMy">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://try.snowplowanalytics.com/?utm_content=hero-cta&amp;utm_campaign=snowplow-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link snwpl-nav-button customized_AOMy">Try Snowplow</a><a href="https://go.snowplowanalytics.com/l/571483/2021-02-19/3sn5nml" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link snwpl-nav-button customized_AOMy">Book a demo</a><div class="toggle_vylO extraSpace_k8HL"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s extraPadding_YQbj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/getting-started-with-snowplow-bdp/">Getting started on Snowplow BDP</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started on Snowplow BDP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/getting-started-on-snowplow-open-source/">Getting started on Snowplow Open Source</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started on Snowplow Open Source&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/try-snowplow/">Try Snowplow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Try Snowplow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/open-source-quick-start/">Snowplow Open Source Quick Start</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Open Source Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/understanding-your-pipeline/">Understanding your pipeline</a><button aria-label="Toggle the collapsible sidebar category &#x27;Understanding your pipeline&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/understanding-tracking-design/">Designing tracking</a><button aria-label="Toggle the collapsible sidebar category &#x27;Designing tracking&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/collecting-data/">Collecting data with Trackers and Webhooks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Collecting data with Trackers and Webhooks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/enriching-your-data/">Enriching your data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Enriching your data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/modeling-your-data/">Modeling your data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Modeling your data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/forwarding-events-to-destinations/">Forwarding events to Destinations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Forwarding events to Destinations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/managing-data-quality/">Managing data quality</a><button aria-label="Toggle the collapsible sidebar category &#x27;Managing data quality&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/using-the-snowplow-console/">Snowplow Console</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Console&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/pipeline-components-and-applications/">Pipeline Components and Applications</a><button aria-label="Toggle the collapsible sidebar category &#x27;Pipeline Components and Applications&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/version-compatibility-matrix/">Version compatibility matrix</a><button aria-label="Toggle the collapsible sidebar category &#x27;Version compatibility matrix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/stream-collector/">Stream Collector</a><button aria-label="Toggle the collapsible sidebar category &#x27;Stream Collector&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/sqs2kinesis/">Sqs2kinesis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Sqs2kinesis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/enrichment-components/">Enrichment</a><button aria-label="Toggle the collapsible sidebar category &#x27;Enrichment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/">Loaders and storage targets</a><button aria-label="Toggle the collapsible sidebar category &#x27;Loaders and storage targets&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/s3-loader/">S3 Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;S3 Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/snowplow-rdb-loader-3-0-0/">RDB Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;RDB Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/snowplow-snowflake-loader/">Snowflake Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowflake Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/">BigQuery Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;BigQuery Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/1-0-x-upgrade-guide/">1.0.x upgrade guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/snowplow-bigquery-loader-configuration-reference/">Configuration reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/">Previous versions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Previous versions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-6-0/">BigQuery Loader (0.6.x)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-5-0/">BigQuery Loader (0.5.x)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-4-0/">BigQuery Loader (0.4.x)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-3-0/">BigQuery Loader (0.3.x)</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/google-cloud-storage-loader/">Google Cloud Storage Loader</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/elasticsearch-loader/">Elasticsearch Loader</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/snowplow-postgres-loader/">Postgres Loader</a><button aria-label="Toggle the collapsible sidebar category &#x27;Postgres Loader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/events-manifest-populator/">Events Manifest Populator</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/loaders-storage-targets/emr-etl-runner/">EmrEtlRunner</a><button aria-label="Toggle the collapsible sidebar category &#x27;EmrEtlRunner&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/iglu/">Iglu</a><button aria-label="Toggle the collapsible sidebar category &#x27;Iglu&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/pipeline-components-and-applications/dataflow-runner/">Dataflow Runner</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/snowplow-mini/">Snowplow Mini</a><button aria-label="Toggle the collapsible sidebar category &#x27;Snowplow Mini&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/piinguin/">Piinguin</a><button aria-label="Toggle the collapsible sidebar category &#x27;Piinguin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/pipeline-components-and-applications/right-to-be-forgotten-spark-application/">Right to be Forgotten Spark Application</a><button aria-label="Toggle the collapsible sidebar category &#x27;Right to be Forgotten Spark Application&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/contributing/">Community &amp; contributing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Community &amp; contributing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/pipeline-components-and-applications/"><span itemprop="name">Pipeline Components and Applications</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/pipeline-components-and-applications/loaders-storage-targets/"><span itemprop="name">Loaders and storage targets</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/"><span itemprop="name">BigQuery Loader</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/"><span itemprop="name">Previous versions</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">BigQuery Loader (0.5.x)</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>BigQuery Loader (0.5.x)</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-architecture">Technical Architecture<a class="hash-link" href="#technical-architecture" title="Direct link to heading">â€‹</a></h2><p>The available tools are:</p><ol><li><strong>Snowplow BigQuery Loader</strong>, an <a href="https://beam.apache.org/" target="_blank" rel="noopener noreferrer">Apache Beam</a> job that reads Snowplow enriched data from Google Pub/Sub, transforms it into BigQuery-friendly format and loads it. It also writes information about encountered data types into an auxiliaryÂ <code>typesTopic</code>Â Pub/Sub topic.</li><li><strong>Snowplow BigQuery Mutator</strong>, a Scala app that reads theÂ <code>typesTopic</code>Â (viaÂ <code>typesSubscription</code>) and performs table mutations to add new columns as required.</li><li><strong>Snowplow BigQuery Repeater</strong>, a Scala app that readsÂ <code>failedInserts</code>Â (caused byÂ <em>mutation lag</em>) and tries to re-insert them into BigQuery after some delay, sinking failures into a dead-end bucket.</li><li><strong>[<!-- -->DEPRECATED<!-- -->]<!-- --> Snowplow BigQuery Forwarder</strong>, an alternative to Repeater implemented as an Apache Beam job. This component has been deprecated from version 0.5.0. Please use Repeater instead.</li></ol><p><img loading="lazy" src="/assets/images/bigquery-microservices-architecture-d8e7fac055f25a9f9be2d4c810d8b9f1.png" width="900" height="338" class="img_ev3q"></p><p>In addition it also includes a fourth microservice, the &quot;repeater&quot;.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="snowplow-bigquery-loader">Snowplow BigQuery Loader<a class="hash-link" href="#snowplow-bigquery-loader" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h4><p>An Apache Beam job intended to run onÂ <a href="https://cloud.google.com/dataflow/" target="_blank" rel="noopener noreferrer">Google Dataflow</a>Â and load enriched data fromÂ <code>enriched</code>Â Pub/Sub topic to Google BigQuery.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm">Algorithm<a class="hash-link" href="#algorithm" title="Direct link to heading">â€‹</a></h4><ul><li>Reads Snowplow enriched events fromÂ <code>input</code>Â Pub/Sub subscription.</li><li>Uses the JSON transformer from theÂ <a href="https://github.com/snowplow/snowplow-scala-analytics-sdk" target="_blank" rel="noopener noreferrer">Snowplow Scala Analytics SDK</a>Â to convert those enriched events into JSONs.</li><li>UsesÂ <a href="https://github.com/snowplow/iglu-scala-client/" target="_blank" rel="noopener noreferrer">Iglu Client</a>Â to fetch JSON schemas for self-describing events and entities.</li><li>UsesÂ <a href="https://github.com/snowplow/iglu/tree/master/0-common/schema-ddl" target="_blank" rel="noopener noreferrer">Iglu Schema DDL</a>Â to transform self-describing events and entities into BigQuery format.</li><li>Writes transformed data into BigQuery.</li><li>Writes all encountered Iglu types into aÂ <code>typesTopic</code>.</li><li>Writes all data failed to be processed into aÂ <code>badRows</code>Â topic.</li><li>Writes data that succeeded to be transformed, but failed to be loaded into aÂ <code>failedInserts</code>Â topic.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="snowplow-bigquery-mutator">Snowplow BigQuery Mutator<a class="hash-link" href="#snowplow-bigquery-mutator" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="overview-1">Overview<a class="hash-link" href="#overview-1" title="Direct link to heading">â€‹</a></h4><p>This is a Scala app that reads data from theÂ <code>typesTopic</code>Â via aÂ <code>typesSubscription</code>Â and performs table mutations.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm-1">Algorithm<a class="hash-link" href="#algorithm-1" title="Direct link to heading">â€‹</a></h4><ul><li>Reads messages fromÂ <code>typesSubscription</code>.</li><li>Finds out if a message contains a type that has not been encountered yet (by checking internal cache).</li><li>If a message contains a new type, double-checks it with the connected BigQuery table.</li><li>If the type is not in the table, fetches its JSON schema from Iglu Registry.</li><li>Transforms JSON schema into BigQuery column definition.</li><li>Adds the column to the connected BigQuery table.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="snowplow-bigquery-repeater">Snowplow BigQuery Repeater<a class="hash-link" href="#snowplow-bigquery-repeater" title="Direct link to heading">â€‹</a></h3><p>A JVM application that reads aÂ <code>failedInserts</code>Â subscription and tries to re-insert them into BigQuery to overcome mutation lag.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="overview-2">Overview<a href="https://github.com/snowplow-incubator/snowplow-bigquery-loader/wiki#overview-3" target="_blank" rel="noopener noreferrer"></a><a class="hash-link" href="#overview-2" title="Direct link to heading">â€‹</a></h4><p>Repeater has several important behaviour aspects:</p><ul><li>If a pulled record is not a valid Snowplow event, it will result into aÂ <code>loader_recovery_error</code>Â bad row.</li><li>If a pulled record is a valid event, Repeater will wait some time (5 minutes by default) after theÂ <code>etl_tstamp</code>Â before attempting to re-insert it, in order to let Mutator do its job.</li><li>If the database responds with an error, the row will get transformed into aÂ <code>loader_recovery_error</code>Â bad row.</li><li>All entities in the dead-end bucket are valid Snowplow bad rows.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mutation-lag">Mutation lag<a class="hash-link" href="#mutation-lag" title="Direct link to heading">â€‹</a></h4><p>Loader inserts data into BigQuery in near real-time. At the same time, it sinksÂ <code>shredded_type</code>Â payloads into theÂ <code>typesTopic</code>Â approximately every 5 seconds. It also can take up to 10-15 seconds for Mutator to fetch, parse the message and execute anÂ <code>ALTER TABLE</code>Â statement against the table.</p><p>If a new type arrives fromÂ <code>input</code>Â subscription in this period of time and Mutator fails to handle it, BigQuery will reject the row containing it and it will be sent to theÂ <code>failedInserts</code>Â topic. This topic contains JSON objectsÂ <em>ready to be loaded into BigQuery</em>Â (ie not canonical Snowplow Enriched event format).</p><p>In order to load this data again fromÂ <code>failedInserts</code>Â to BigQuery you can use Repeater or Forwarder (see below). Both read a subscription fromÂ <code>failedInserts</code>Â and performÂ <code>INSERT</code>Â statements.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deprecated-snowplow-bigquery-forwarder">[<!-- -->DEPRECATED<!-- -->]<!-- --> Snowplow BigQuery Forwarder<a class="hash-link" href="#deprecated-snowplow-bigquery-forwarder" title="Direct link to heading">â€‹</a></h3><p>This component has been deprecated from version 0.5.0. Please use Repeater instead. The documentation on Forwarder that follows is outdated and no longer maintained. It will be removed in future versions.</p><p>Used for exactly the same purpose as Repeater, but uses Dataflow under the hood, which makes it suitable for very big amounts of data. At the same time, it has several important drawbacks compared with Repeater:</p><ul><li>User needs to re-launch it manually when failed inserts appear.</li><li>Otherwise, it could be extremely expensive to run a Dataflow job that idles 99.9% of the time (it cannot terminate as it is a streaming/infinite job1).</li><li>There&#x27;s no way to tell Forwarder that it should take a pause before inserting rows back. Without the pause there&#x27;s a chance that Mutator doesn&#x27;t get a chance to alter the table.</li><li>Forwarder keeps retrying all inserts (default behaviour for streaming Dataflow jobs), while Repeater has a dead-end GCS bucket.</li><li>In order to debug a problem with Forwarder, operator needs to inspect Stackdriver logs.</li></ul><p>1Forwarder is a very generic and primitive Dataflow job. It could be launched using the standard Dataflow templates. But a standard template job cannot accept a subscription as a source, only a topic. That means the job must be running all the time and most of the time it will be idle.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="topics-and-message-formats">Topics and message formats<a class="hash-link" href="#topics-and-message-formats" title="Direct link to heading">â€‹</a></h3><p>Snowplow BigQuery Loader uses Google Pub/Sub topics and subscriptions to store intermediate data and communicate between applications.</p><ul><li><code>input</code>Â subscription -- data enriched by Beam Enrich, in canonicalÂ <code>TSV+JSON format</code>;</li><li><code>typesTopic</code>Â -- all shredded types inÂ <code>iglu:com.snowplowanalytics.snowplow/shredded_type/jsonschema/1-0-0</code>Â self-describing payload encountered by Loader are sinked here with ~5 seconds interval;</li><li><code>typesSubscription</code>Â -- a subscription toÂ <code>typesTopic</code>Â used by Mutator withÂ <code>iglu:com.snowplowanalytics.snowplow/shredded_type/jsonschema/1-0-0</code>Â self-describing payloads;</li><li><code>badRows</code>Â topic -- data that could not be processed by Loader due to Iglu Registry unavailability, formatted asÂ <code>bad rows</code>;</li><li><code>failedInserts</code>Â topic -- data that has been successfully transformed by Loader, but failed loading to BigQuery usually due to mutation lag, formatted asÂ <code>BigQuery JSON</code>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-guide">Setup guide<a class="hash-link" href="#setup-guide" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-file">Configuration file<a class="hash-link" href="#configuration-file" title="Direct link to heading">â€‹</a></h3><p>Loader, Mutator and Repeater (Forwarder has been deprecated) accept the same configuration file with <a href="https://github.com/snowplow/iglu-central/tree/master/schemas/com.snowplowanalytics.snowplow.storage/bigquery_config/jsonschema" target="_blank" rel="noopener noreferrer">iglu:com.snowplowanalytics.snowplow.storage/bigquery<!-- -->_<!-- -->config/jsonschema/</a>Â schema, which looks like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;schema&quot;: &quot;iglu:com.snowplowanalytics.snowplow.storage/bigquery_config/jsonschema/1-0-0&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;data&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;name&quot;: &quot;Alpha BigQuery test&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;id&quot;: &quot;31b1559d-d319-4023-aaae-97698238d808&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;projectId&quot;: &quot;com-acme&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;datasetId&quot;: &quot;snowplow&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;tableId&quot;: &quot;events&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;input&quot;: &quot;enriched-good-sub&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;typesTopic&quot;: &quot;bq-test-types&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;typesSubscription&quot;: &quot;bq-test-types-sub&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;badRows&quot;: &quot;bq-test-bad-rows&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;failedInserts&quot;: &quot;bq-test-bad-inserts&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;load&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;mode&quot;: &quot;STREAMING_INSERTS&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;retry&quot;: false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;purpose&quot;: &quot;ENRICHED_EVENTS&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>All topics and subscriptions (<code>input</code>,Â <code>typesTopic</code>,Â <code>typesSubscription</code>,Â <code>badRows</code>Â andÂ <code>failedInserts</code>) are explained in theÂ <a href="/docs/getting-started-on-snowplow-open-source/setup-snowplow-on-gcp/setup-bigquery-destination/#topics-and-message-formats">topics and message formats</a>Â section.</li><li><code>projectId</code>Â is used to group all resources (topics, subscriptions and BigQuery table).</li><li><code>datasetId</code>Â andÂ <code>tableId</code>Â (along withÂ <code>projectId</code>) specify the target BigQuery table.</li><li><code>name</code>Â is an arbitrary human-readable description of the storage target.</li><li><code>id</code>Â is a unique identificator in UUID format.</li><li><code>load</code>Â specifies the loading mode and is explained in the dedicated section below.</li><li><code>purpose</code>Â is a standard storage configuration. Its only valid value currently isÂ <code>ENRICHED_EVENTS</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="loading-mode">Loading mode<a class="hash-link" href="#loading-mode" title="Direct link to heading">â€‹</a></h4><p>BigQuery supports two loading APIs:</p><ul><li><a href="https://cloud.google.com/bigquery/streaming-data-into-bigquery" target="_blank" rel="noopener noreferrer">Streaming inserts API</a></li><li><a href="https://cloud.google.com/bigquery/docs/reference/rest/v2/jobs" target="_blank" rel="noopener noreferrer">Load jobs API</a></li></ul><p>You can use theÂ <code>load</code>Â property to configure Loader to use one of them.</p><p>For example, the configuration for usingÂ <strong>streaming inserts</strong>Â can look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;load&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;mode&quot;: &quot;STREAMING_INSERTS&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;retry&quot;: false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>retry</code>Â specifies if failed inserts (eg due to mutation lag) should be retried infinitely or sent straight to theÂ <code>failedInserts</code>Â topic. If a row cannot be inserted, it will be re-tried indefinitely, which can throttle the whole job. In that case a restart might be required.</p><p>The configuration for usingÂ <strong>load jobs</strong>Â can look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;load&quot;: {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;mode&quot;: &quot;FILE_LOADS&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;frequency&quot;: 60000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>frequency</code>Â specifies how often the load job should be performed, in seconds. Unlike the near-real-timeÂ <strong>streaming inserts</strong>Â API, load jobs are more batch-oriented.</p><p>Load jobs do not supportÂ <code>retry</code>Â (and streaming inserts do not supportÂ <code>frequency</code>).</p><p>It is generally recommended to stick with theÂ <strong>streaming jobs</strong>Â API without retries and useÂ <a href="/docs/getting-started-on-snowplow-open-source/setup-snowplow-on-gcp/setup-bigquery-destination/#snowplow-bigquery-repeater">Repeater</a>Â to recover data fromÂ <code>failedInserts</code>. However, theÂ <strong>load jobs</strong>Â API is cheaper and generates fewer duplicates.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="command-line-options">Command line options<a class="hash-link" href="#command-line-options" title="Direct link to heading">â€‹</a></h3><p>All four apps accept a path to a config file as specified above, and to an Iglu resolver config.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="loader">Loader<a class="hash-link" href="#loader" title="Direct link to heading">â€‹</a></h4><p>Loader accepts two required arguments, one optional argument, andÂ <a href="https://cloud.google.com/dataflow/pipelines/specifying-exec-params#setting-other-cloud-pipeline-options" target="_blank" rel="noopener noreferrer">any other</a>Â supported by Google Cloud Dataflow.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./snowplow-bigquery-loader \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --config=$CONFIG \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --resolver=$RESOLVER</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --labels={&quot;key1&quot;:&quot;val1&quot;,&quot;key2&quot;:&quot;val2&quot;} # optional</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The optionalÂ <code>labels</code>Â argument is an example of a Dataflow natively supported argument. It accepts a JSON with key-value pairs that will be used asÂ <a href="https://cloud.google.com/compute/docs/labeling-resources" target="_blank" rel="noopener noreferrer">labels</a>Â to the Cloud Dataflow job.</p><p>This can be launched from any machine authenticated to submit Dataflow jobs.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mutator">Mutator<a class="hash-link" href="#mutator" title="Direct link to heading">â€‹</a></h4><p>Mutator has three subcommands:Â <code>listen</code>,Â <code>create</code>Â andÂ <code>add-column</code>.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="listen"><code>listen</code><a class="hash-link" href="#listen" title="Direct link to heading">â€‹</a></h5><p><code>listen</code>Â is the primary command and is used to automate table migrations.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./snowplow-bigquery-mutator \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    listen</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --config $CONFIG \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --resolver $RESOLVER \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --verbose               # Optional, for debugging only</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="add-column"><code>add-column</code><a class="hash-link" href="#add-column" title="Direct link to heading">â€‹</a></h5><p><code>add-column</code>Â can be used once to add a column manually. This should eliminate the risk of mutation lag and the necessity to run a Repeater or Forwarder job.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./snowplow-bigquery-mutator \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    add-column \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --config $CONFIG \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --resolver $RESOLVER \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --shred-property CONTEXTS \ --schema iglu:com.acme/app_context/jsonschema/1-0-0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The specified schema must be present in one of the Iglu registries in the resolver configuration.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="create"><code>create</code><a class="hash-link" href="#create" title="Direct link to heading">â€‹</a></h5><p><code>create</code>Â creates an empty table withÂ <code>atomic</code>Â structure.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./snowplow-bigquery-mutator \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    create \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --config $CONFIG \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --resolver $RESOLVER</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="repeater">Repeater<a class="hash-link" href="#repeater" title="Direct link to heading">â€‹</a></h4><p>We recommend constantly running Repeater on a small / cheap node or Docker container.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./snowplow-bigquery-repeater \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    create \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --config $CONFIG \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --resolver $RESOLVER \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --failedInsertsSub $FAILED_INSERTS_SUB \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --deadEndBucket $DEAD_END_GCS \   # Must start with gcs:\\ prefix</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --desperatesBufferSize 20 \       # Size of the batch to send to the dead-end bucket</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --desperatesWindow 20 \           # Window duration after which bad rows will be sunk into the dead-end bucket</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --backoffPeriod 900               # Seconds to wait before attempting a re-insert (calculated against etl_tstamp)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>desperatesBufferSize</code>,Â <code>desperatesWindow</code>Â andÂ <code>backoffPeriod</code>Â are optional parameters.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="deprecated-forwarder">[<!-- -->DEPRECATED<!-- -->]<!-- --> Forwarder<a class="hash-link" href="#deprecated-forwarder" title="Direct link to heading">â€‹</a></h4><p>This component has been deprecated from version 0.5.0. Please use Repeater instead. The documentation on Forwarder that follows is outdated and no longer maintained. It will be removed in future versions.</p><p>Like Loader, Forwarder can be submitted from any machine authenticated to submit Dataflow jobs.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./snowplow-bigquery-forwarder \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --config=$CONFIG \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --resolver=$RESOLVER</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --labels={&quot;key1&quot;:&quot;val1&quot;,&quot;key2&quot;:&quot;val2&quot;} # optional</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --failedInsertsSub=$FAILED_INSERTS_SUB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Its only unique option isÂ <code>failedInsertsSub</code>, which is a subscription (that must be createdÂ <em>upfront</em>) to theÂ <code>failedInserts</code>Â topic.</p><p>TheÂ <code>labels</code>Â argument works the same as with Loader.</p><p>By convention both Dataflow jobs (Forwarder and Loader) accept CLI options withÂ <code>=</code>Â symbol and camelCase, while Mutator and Repeater accept them in UNIX style (withoutÂ <code>=</code>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-support">Docker support<a class="hash-link" href="#docker-support" title="Direct link to heading">â€‹</a></h3><p>All four applications are available as Docker images.</p><ul><li><code>snowplow/snowplow-bigquery-loader:0.5.0</code></li><li><code>snowplow/snowplow-bigquery-mutator:0.5.0</code></li><li><code>snowplow/snowplow-bigquery-repeater:0.5.0</code></li><li><code>snowplow/snowplow-bigquery-forwarder:0.5.0</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="partitioning">Partitioning<a class="hash-link" href="#partitioning" title="Direct link to heading">â€‹</a></h3><p>During initial setup it is strongly recommended toÂ <a href="https://cloud.google.com/bigquery/docs/creating-column-partitions" target="_blank" rel="noopener noreferrer">setup partitioning</a>Â on theÂ <code>derived_tstamp</code>Â property. Mutator&#x27;sÂ <code>create</code>Â command does not automatically add partitioning yet.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/snowplow/snowplow.github.io/tree/main/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-5-0/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-09-09T12:18:35.000Z">Sep 9, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-6-0/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">BigQuery Loader (0.6.x)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/pipeline-components-and-applications/loaders-storage-targets/bigquery-loader/previous-versions/bigquery-loader-0-4-0/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">BigQuery Loader (0.4.x)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#technical-architecture" class="table-of-contents__link toc-highlight">Technical Architecture</a><ul><li><a href="#snowplow-bigquery-loader" class="table-of-contents__link toc-highlight">Snowplow BigQuery Loader</a></li><li><a href="#snowplow-bigquery-mutator" class="table-of-contents__link toc-highlight">Snowplow BigQuery Mutator</a></li><li><a href="#snowplow-bigquery-repeater" class="table-of-contents__link toc-highlight">Snowplow BigQuery Repeater</a></li><li><a href="#deprecated-snowplow-bigquery-forwarder" class="table-of-contents__link toc-highlight">[DEPRECATED] Snowplow BigQuery Forwarder</a></li><li><a href="#topics-and-message-formats" class="table-of-contents__link toc-highlight">Topics and message formats</a></li></ul></li><li><a href="#setup-guide" class="table-of-contents__link toc-highlight">Setup guide</a><ul><li><a href="#configuration-file" class="table-of-contents__link toc-highlight">Configuration file</a></li><li><a href="#command-line-options" class="table-of-contents__link toc-highlight">Command line options</a></li><li><a href="#docker-support" class="table-of-contents__link toc-highlight">Docker support</a></li><li><a href="#partitioning" class="table-of-contents__link toc-highlight">Partitioning</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a class="footer__link-item" href="/cookie-preferences/">Change cookie preferences</a><span class="footer__link-separator">Â·</span><a class="footer__link-item" href="/terms-and-conditions/">Terms and conditions</a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Snowplow Analytics Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a25030c0.js"></script>
<script src="/assets/js/main.cac1a3dd.js"></script>
</body>
</html>