"use strict";(self.webpackChunkdocsite_poc_github_io=self.webpackChunkdocsite_poc_github_io||[]).push([[7911],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),p=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},s=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),s=p(n),u=r,h=s["".concat(d,".").concat(u)]||s[u]||c[u]||i;return n?a.createElement(h,l(l({ref:t},m),{},{components:n})):a.createElement(h,l({ref:t},m))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=s;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}s.displayName="MDXCreateElement"},59110:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const i={title:"What is the enrichment process?",date:"2020-02-15",sidebar_position:0},l=void 0,o={unversionedId:"enriching-your-data/what-is-enrichment/index",id:"enriching-your-data/what-is-enrichment/index",title:"What is the enrichment process?",description:"Overview",source:"@site/docs/enriching-your-data/what-is-enrichment/index.md",sourceDirName:"enriching-your-data/what-is-enrichment",slug:"/enriching-your-data/what-is-enrichment/",permalink:"/docs/enriching-your-data/what-is-enrichment/",draft:!1,editUrl:"https://github.com/snowplow/snowplow.github.io/tree/main/docs/enriching-your-data/what-is-enrichment/index.md",tags:[],version:"current",lastUpdatedAt:1662725915,formattedLastUpdatedAt:"Sep 9, 2022",sidebarPosition:0,frontMatter:{title:"What is the enrichment process?",date:"2020-02-15",sidebar_position:0},sidebar:"defaultSidebar",previous:{title:"Enriching your data",permalink:"/docs/enriching-your-data/"},next:{title:"Managing enrichments in the console",permalink:"/docs/enriching-your-data/configuring-enrichments/"}},d={},p=[{value:"Overview",id:"overview",level:3},{value:"Hardcoded enrichments",id:"hardcoded-enrichments",level:3},{value:"Configurable enrichment",id:"configurable-enrichment",level:3}],m={toc:p};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h3",{id:"overview"},"Overview"),(0,r.kt)("p",null,"During Enrichment your events have extra properties and values attached to them, also know as dimension widening."),(0,r.kt)("p",null,"Snowplow enrichments can be categorized into three brackets:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Hardcoded enrichments loading\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"atomic.events"),"\xa0(legacy)"),(0,r.kt)("li",{parentName:"ul"},"Configurable enrichments loading\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"atomic.events"),"\xa0(legacy)"),(0,r.kt)("li",{parentName:"ul"},"Configurable enrichments adding new contexts to the\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"derived_contexts"),"\xa0JSON array")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Legacy enrichments"),"\xa0are those which populate\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"atomic.events"),"\xa0table as opposed to dedicated enrichment tables. The hardcoded legacy enrichments normally take place as part of common enrichment process and they precede configurable enrichments. During the common enrichment process the data received from collector(s) is mapped according to our\xa0",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/snowplow/wiki/canonical-event-model"},"Canonical Event Model"),"."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Configurable enrichments"),"\xa0often depend on the data produced by the common enrichment process."),(0,r.kt)("h3",{id:"hardcoded-enrichments"},(0,r.kt)("a",{parentName:"h3",href:"https://github.com/snowplow/snowplow/wiki/The-enrichment-process#hardcoded-enrichment"}),"Hardcoded enrichments"),(0,r.kt)("p",null,"The following fields are populated depending on whether the tracker provided the corresponding value or not."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Raw Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Enriched Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Purpose"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"eid")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"event_id")),(0,r.kt)("td",{parentName:"tr",align:null},"The unique event identifier (UUID). Assigned during enrichment if not provided with\xa0",(0,r.kt)("inlineCode",{parentName:"td"},"eid"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"cv")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"v_collector")),(0,r.kt)("td",{parentName:"tr",align:null},"Collector type/version")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"tnuid")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"network_userid")),(0,r.kt)("td",{parentName:"tr",align:null},"User ID set by Snowplow using 3rd party cookie. Overwriten with tracker-set\xa0",(0,r.kt)("inlineCode",{parentName:"td"},"tnuid"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ip")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"user_ipaddress")),(0,r.kt)("td",{parentName:"tr",align:null},"Snowplow collectors log IP address as standard. However, you can override the value derived from the collector by populating this value in the tracker.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ua")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"useragent")),(0,r.kt)("td",{parentName:"tr",align:null},"Raw useragent (browser string). Could be overwritten with\xa0",(0,r.kt)("inlineCode",{parentName:"td"},"ua"),".")))),(0,r.kt)("p",null,"The following fields are populated depending on the collector and ETL (Extract, Transform, Load) utilized in the pipeline."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Added Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Purpose"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"v_etl")),(0,r.kt)("td",{parentName:"tr",align:null},"Host ETL version")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"etl_tstamp")),(0,r.kt)("td",{parentName:"tr",align:null},"Timestamp event began ETL")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"collector_tstamp")),(0,r.kt)("td",{parentName:"tr",align:null},"Time stamp for the event recorded by the collector")))),(0,r.kt)("p",null,"The raw parameter\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"res"),"\xa0(if present) representing the screen/monitor resolution and coming in as a combination of width and height (ex.\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"1280x1024"),") is broken up into separate entities."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Added Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Purpose"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"dvce_screenwidth")),(0,r.kt)("td",{parentName:"tr",align:null},"Screen / monitor width")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"dvce_screenheight")),(0,r.kt)("td",{parentName:"tr",align:null},"Screen / monitor height")))),(0,r.kt)("p",null,"The\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"url"),"\xa0parameter provides the value for\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"page_url"),"\xa0in\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"atomic.events"),", which represents the current page's URL. The following parts are extracted and populate separate fields as outlined below."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Added Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Purpose"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"page_urlscheme")),(0,r.kt)("td",{parentName:"tr",align:null},'Scheme (protocol), ex. "http"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"page_urlhost")),(0,r.kt)("td",{parentName:"tr",align:null},'Host (domain), ex. "',(0,r.kt)("a",{parentName:"td",href:"http://www.snowplowanalytics.com%22"},'www.snowplowanalytics.com"'))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"page_urlport")),(0,r.kt)("td",{parentName:"tr",align:null},"Port if specified, 80 if not")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"page_urlpath")),(0,r.kt)("td",{parentName:"tr",align:null},'Path to page, ex. "/product/index.html"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"page_urlquery")),(0,r.kt)("td",{parentName:"tr",align:null},'Querystring, ex. "id=GTM-DLRG"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"page_urlfragment")),(0,r.kt)("td",{parentName:"tr",align:null},'Fragment (anchor), ex. "4-conclusion"')))),(0,r.kt)("p",null,"Similarly,\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"page_referrer"),"\xa0gets the value from\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"refr"),", which represents the referer\u2019s URL, and the following parts are extracted and populate separate fields as shown below."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Added Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Purpose"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"refr_urlscheme")),(0,r.kt)("td",{parentName:"tr",align:null},"Scheme (protocol)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"refr_urlhost")),(0,r.kt)("td",{parentName:"tr",align:null},"Host (domain)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"refr_urlport")),(0,r.kt)("td",{parentName:"tr",align:null},"Port if specified, 80 if not")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"refr_urlpath")),(0,r.kt)("td",{parentName:"tr",align:null},"Path to page")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"refr_urlquery")),(0,r.kt)("td",{parentName:"tr",align:null},"Querystring")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"refr_urlfragment")),(0,r.kt)("td",{parentName:"tr",align:null},"Fragment (anchor)")))),(0,r.kt)("p",null,"Additionally the derived timestamp is calculated,\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"derived_tstamp"),". See\xa0",(0,r.kt)("a",{parentName:"p",href:"https://snowplowanalytics.com/blog/2015/09/15/improving-snowplows-understanding-of-time/"},"this blog post"),"\xa0for more details."),(0,r.kt)("p",null,"Finally, contexts, unstructured events and the relevant configurable enrichments (if enabled) are validated against their corresponding JSON schemas and the array of the derived contexts is assembled."),(0,r.kt)("h3",{id:"configurable-enrichment"},(0,r.kt)("a",{parentName:"h3",href:"https://github.com/snowplow/snowplow/wiki/The-enrichment-process#configurable-enrichment"}),"Configurable enrichment"),(0,r.kt)("p",null,"All configurable enrichments are listed on the ",(0,r.kt)("a",{parentName:"p",href:"/docs/enriching-your-data/available-enrichments/"},"Available Enrichments")," page."),(0,r.kt)("p",null,"The following configurable enrichments write data into\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"atomic.events"),"\xa0table (legacy enrichments):"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/ip-anonymization-enrichment/"},"IP anonymization enrichment")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/ip-lookup-enrichment/"},"IP lookups enrichment")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/campaign-attribution-enrichment/"},"Campaign attribution enrichment")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/currency-conversion-enrichment/"},"Currency conversion enrichment")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/referrer-parser-enrichment/"},"referer-parser enrichment")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/event-fingerprint-enrichment/"},"Event fingerprint enrichment"))),(0,r.kt)("p",null,"All other configurable enrichments create a separate context and thus are loaded into their own dedicated tables."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/snowplow/wiki/_Footer/_edit"})))}c.isMDXComponent=!0}}]);