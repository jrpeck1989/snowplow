"use strict";(self.webpackChunkdocsite_poc_github_io=self.webpackChunkdocsite_poc_github_io||[]).push([[26751],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(a),m=r,k=d["".concat(l,".").concat(m)]||d[m]||u[m]||o;return a?n.createElement(k,i(i({ref:t},p),{},{components:a})):n.createElement(k,i({ref:t},p))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},50450:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=a(87462),r=(a(67294),a(3905)),o=a(41481);const i={title:"Additional options",date:"2021-03-25",sidebar_position:3e3},s=void 0,l={unversionedId:"collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/additional-options/index",id:"collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/additional-options/index",title:"Additional options",description:"Toggling Anonymous Tracking",source:"@site/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/additional-options/index.md",sourceDirName:"collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/additional-options",slug:"/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/additional-options/",permalink:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/additional-options/",draft:!1,editUrl:"https://github.com/snowplow/snowplow.github.io/tree/main/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/additional-options/index.md",tags:[],version:"current",lastUpdatedAt:1662725915,formattedLastUpdatedAt:"Sep 9, 2022",sidebarPosition:3e3,frontMatter:{title:"Additional options",date:"2021-03-25",sidebar_position:3e3},sidebar:"defaultSidebar",previous:{title:"Initialization options",permalink:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/initialization-options/"},next:{title:"Managing multiple trackers",permalink:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/managing-multiple-trackers/"}},c={},p=[{value:"Toggling Anonymous Tracking",id:"toggling-anonymous-tracking",level:4},{value:"Disable Anonymous Tracking",id:"disable-anonymous-tracking",level:5},{value:"Enable Anonymous Tracking",id:"enable-anonymous-tracking",level:5},{value:"Clear user data",id:"clear-user-data",level:5},{value:"Setting the user ID",id:"setting-the-user-id",level:4},{value:"<code>setUserId</code>",id:"setuserid",level:5},{value:"<code>setUserIdFromLocation</code>",id:"setuseridfromlocation",level:5},{value:"<code>setUserIdFromReferrer</code>",id:"setuseridfromreferrer",level:5},{value:"<code>setUserIdFromCookie</code>",id:"setuseridfromcookie",level:5},{value:"Setting a custom page URL and referrer URL",id:"setting-a-custom-page-url-and-referrer-url",level:4}],u={toc:p};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(o.ZP,{mdxType:"Block5966"}),(0,r.kt)("h4",{id:"toggling-anonymous-tracking"},"Toggling Anonymous Tracking"),(0,r.kt)("p",null,"The JavaScript Tracker can be initialised with ",(0,r.kt)("inlineCode",{parentName:"p"},"anonymousTracking: true")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"anonymousTracking: { withSessionTracking: true }")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"anonymousTracking: { withServerAnonymisation: true }"),". You can read more about the anonymous tracking features ",(0,r.kt)("a",{parentName:"p",href:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/initialization-options/#Anonymous_Tracking"},"here"),"."),(0,r.kt)("p",null,"You may wish to toggle this functionality on or off during a page visit, for example when a user accepts a cookie banner you may not want to disable anonymous tracking, or when a user logs in to your site."),(0,r.kt)("h5",{id:"disable-anonymous-tracking"},"Disable Anonymous Tracking"),(0,r.kt)("p",null,"To do this you can call the following methods:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('disableAnonymousTracking');\n")),(0,r.kt)("p",null,"or, if you wish to also adjust the ",(0,r.kt)("inlineCode",{parentName:"p"},"stateStorageStrategy")," when enabling:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('disableAnonymousTracking', { \n  stateStorageStrategy: 'cookieAndLocalStorage' \n});\n")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"If configuring the tracker with ",(0,r.kt)("inlineCode",{parentName:"p"},"stateStorageStrategy: 'localStorage'")," and anonymous tracking using ",(0,r.kt)("inlineCode",{parentName:"p"},"withSessionTracking: true"),", then if you change to a ",(0,r.kt)("inlineCode",{parentName:"p"},"stateStorageStrategy")," which prefer cookies such as ",(0,r.kt)("inlineCode",{parentName:"p"},"cookie")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"cookieAndLocalStorage")," then the session identifiers will reset. To maintain session identifiers, ensure you use the same ",(0,r.kt)("inlineCode",{parentName:"p"},"stateStorageStrategy"),".")),(0,r.kt)("h5",{id:"enable-anonymous-tracking"},"Enable Anonymous Tracking"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Enabling Anonymous tracking will clear all current user, session and page data from events sent to the collector. Although not sent in requests to collector, existing user and session identifiers will not be removed from cookies or local storage. See below for information on how to clear user data.")),(0,r.kt)("p",null,"If you wish to enable Anonymous Tracking, you can call:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('enableAnonymousTracking');\n")),(0,r.kt)("p",null,"which will enable client side anonymous tracking."),(0,r.kt)("p",null,"For full, cookieless, anonymisation, including anonymising data within the Snowplow Collector (cookies and ip address), then you can enable server anonymisation too:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('enableAnonymousTracking', {\n  options: { withServerAnonymisation: true }\n});\n")),(0,r.kt)("p",null,"Server Anonymisation requires the Snowplow Stream Collector v2.1.0+. Using a lower version will cause events to fail to send until Server Anonymisation is disabled."),(0,r.kt)("p",null,"If you want to enable anonymous tracking with session tracking, then you can use:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('enableAnonymousTracking', {\n  options: { withSessionTracking: true }\n});\n")),(0,r.kt)("p",null,"From v3.1.0 it's also possible to change the ",(0,r.kt)("inlineCode",{parentName:"p"},"stateStorageStrategy")," when enabling Anonymous Tracking, allowing you to switch off storage when turning anonymous tracking on:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('enableAnonymousTracking', { options: {}, stateStorageStrategy: 'none' }); // Available from v3.1.0\n")),(0,r.kt)("h5",{id:"clear-user-data"},"Clear user data"),(0,r.kt)("p",null,"If you wish to clear all the cookies and local storage values which contain user data when switching on anonymous tracking, or triggered by other actions on your site, you can call the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('clearUserData');\n")),(0,r.kt)("p",null,"From v3.1, this will also clear in memory session and user identifiers too. This ensures all possible identifiers are cleared and even if tracking is resumed you will see new session and user identifiers. If you\u2019d like to preserve the in-memory session and user identifiers, for future events should you continue tracking after clearing the cookies, you can do so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('clearUserData', { preserveSession: true, preserveUser: true });\n")),(0,r.kt)("h4",{id:"setting-the-user-id"},"Setting the user ID"),(0,r.kt)("p",null,"The JavaScript Tracker automatically sets a\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"domain_userid"),"\xa0based on a first party cookie."),(0,r.kt)("p",null,"There are many situations, however, when you will want to identify a specific user using an ID generated by one of your business systems. To do this, you use one of the methods described in this section:\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setUserId"),",\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setUserIdFromLocation"),",\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setUserIdFromReferrer"),", and\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setUserIdFromCookie"),"."),(0,r.kt)("p",null,"Typically, companies do this at points in the customer journey when the user identifies him / herself e.g. if he / she logs in."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"This will only set the user ID on further events fired while the user is on this page; if you want events on another page to record this user ID too, you must call\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setUserId"),"\xa0on the other page as well.")),(0,r.kt)("h5",{id:"setuserid"},(0,r.kt)("inlineCode",{parentName:"h5"},"setUserId")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"setUserId"),"\xa0is the simplest of the four methods. It sets the business user ID to a string of your choice:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('setUserId', 'joe.blogs@email.com');\n")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"setUserId"),"\xa0can also be called using the alias\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"identifyUser"),".")),(0,r.kt)("h5",{id:"setuseridfromlocation"},(0,r.kt)("inlineCode",{parentName:"h5"},"setUserIdFromLocation")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"setUserIdFromLocation"),"\xa0lets you set the user ID based on a querystring field of your choice. For example, if the URL is\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"http://www.mysite.com/home?id=user345"),", then the following code would set the user ID to \u201cuser345\u201d:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('setUserIdFromLocation', 'id');\n")),(0,r.kt)("h5",{id:"setuseridfromreferrer"},(0,r.kt)("inlineCode",{parentName:"h5"},"setUserIdFromReferrer")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"setUserIdFromReferrer"),"\xa0functions in the same way as\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setUserIdFromLocation"),", except that it uses the referrer querystring rather than the querystring of the current page."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('setUserIdFromReferrer', 'id');\n")),(0,r.kt)("h5",{id:"setuseridfromcookie"},(0,r.kt)("inlineCode",{parentName:"h5"},"setUserIdFromCookie")),(0,r.kt)("p",null,"Use\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setUserIdFromCookie"),"\xa0to set the value of a cookie as the user ID. For example, if you have a cookie called \u201ccookieid\u201d whose value is \u201cuser123\u201d, the following code would set the user ID to \u201cuser123\u201d:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('setUserIdFromCookie', 'cookieid');\n")),(0,r.kt)("h4",{id:"setting-a-custom-page-url-and-referrer-url"},"Setting a custom page URL and referrer URL"),(0,r.kt)("p",null,"The Snowplow JavaScript Tracker automatically tracks the page URL and referrerURL on any event tracked. However, in certain situations, you may want to override the one or both of these URLs with a custom value. (For example, this might be desirable if your CMS spits out particularly ugly URLs that are hard to unpick at analysis time.)"),(0,r.kt)("p",null,"To set a custom page URL, use the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setCustomUrl"),"\xa0method:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('setCustomUrl', 'http://mysite.com/checkout-page');\n")),(0,r.kt)("p",null,"To set a custom referrer, use the\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setReferrerUrl"),"\xa0method:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('setReferrerUrl', 'http://custom-referrer.com');\n")),(0,r.kt)("p",null,"On a single-page app, the page URL might change without the page being reloaded. Whenever an event is fired, the Tracker checks whether the page URL has changed since the last event. If it has, the page URL is updated and the URL at the time of the last event is used as the referrer. If you use\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setCustomUrl"),", the page URL will no longer be updated in this way. If you use\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setReferrerUrl"),", the referrer URL will no longer be updated in this way."),(0,r.kt)("p",null,"If you want to ensure that the original referrer is preserved even though your page URL can change without the page being reloaded, use\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"setReferrerUrl"),"\xa0like this before sending any events:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"snowplow('setReferrerUrl', document.referrer);\n")))}d.isMDXComponent=!0},41481:(e,t,a)=>{a.d(t,{ZP:()=>i});var n=a(87462),r=(a(67294),a(3905));const o={toc:[]};function i(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},o,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/snowplow/snowplow-javascript-tracker/releases"},(0,r.kt)("img",{parentName:"a",src:"https://img.shields.io/github/v/release/snowplow/snowplow-javascript-tracker?include_prereleases&sort=semver&style=flat",alt:null}))))}i.isMDXComponent=!0}}]);