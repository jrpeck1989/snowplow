"use strict";(self.webpackChunkdocsite_poc_github_io=self.webpackChunkdocsite_poc_github_io||[]).push([[2202],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(a),m=o,w=u["".concat(s,".").concat(m)]||u[m]||c[m]||r;return a?n.createElement(w,i(i({ref:t},d),{},{components:a})):n.createElement(w,i({ref:t},d))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<r;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},20236:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var n=a(87462),o=(a(67294),a(3905));const r={title:"dbt: Web data model",date:"2021-07-27",sidebar_position:200},i=void 0,l={unversionedId:"modeling-your-data/the-snowplow-web-data-model/dbt-web-data-model/index",id:"modeling-your-data/the-snowplow-web-data-model/dbt-web-data-model/index",title:"dbt: Web data model",description:"The snowplow-web dbt package provides a means to run the standard web model via dbt. It processes events incrementally and is designed in a modular manner, allowing you to easily integrate your own custom SQL into the incremental framework provided by the package.",source:"@site/docs/modeling-your-data/the-snowplow-web-data-model/dbt-web-data-model/index.md",sourceDirName:"modeling-your-data/the-snowplow-web-data-model/dbt-web-data-model",slug:"/modeling-your-data/the-snowplow-web-data-model/dbt-web-data-model/",permalink:"/docs/modeling-your-data/the-snowplow-web-data-model/dbt-web-data-model/",draft:!1,editUrl:"https://github.com/snowplow/snowplow.github.io/tree/main/docs/modeling-your-data/the-snowplow-web-data-model/dbt-web-data-model/index.md",tags:[],version:"current",lastUpdatedAt:1662725915,formattedLastUpdatedAt:"Sep 9, 2022",sidebarPosition:200,frontMatter:{title:"dbt: Web data model",date:"2021-07-27",sidebar_position:200},sidebar:"defaultSidebar",previous:{title:"sql-runner: Web data model",permalink:"/docs/modeling-your-data/the-snowplow-web-data-model/sql-runner-web-data-model/"},next:{title:"The Snowplow mobile data model",permalink:"/docs/modeling-your-data/the-snowplow-mobile-data-model/"}},s={},p=[{value:"Quickstart",id:"quickstart",level:2},{value:"Requirements",id:"requirements",level:4},{value:"Prerequisites",id:"prerequisites",level:4},{value:"Supported Warehouses",id:"supported-warehouses",level:4},{value:"Installing the package",id:"installing-the-package",level:4},{value:"Essential Configuration",id:"essential-configuration",level:4},{value:"1 - Check source data",id:"1---check-source-data",level:5},{value:"2 - Enabled desired contexts",id:"2---enabled-desired-contexts",level:5},{value:"3 - Filter your data set",id:"3---filter-your-data-set",level:5},{value:"4 - Verify page ping variables",id:"4---verify-page-ping-variables",level:5},{value:"Further configuration",id:"further-configuration",level:4},{value:"Operation",id:"operation",level:4},{value:"Testing",id:"testing",level:4},{value:"Customizing the web model",id:"customizing-the-web-model",level:2}],d={toc:p};function c(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The snowplow-web dbt package provides a means to run the standard web model via dbt. It processes events incrementally and is designed in a modular manner, allowing you to easily integrate your own custom SQL into the incremental framework provided by the package."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"The package can be found in the ",(0,o.kt)("a",{parentName:"strong",href:"https://github.com/snowplow/dbt-snowplow-web"},"snowplow/dbt-snowplow-web repo"),", with the full doc site hosted ",(0,o.kt)("a",{parentName:"strong",href:"https://snowplow.github.io/dbt-snowplow-web/#!/overview/snowplow_web"},"here"),".")),(0,o.kt)("h2",{id:"quickstart"},"Quickstart"),(0,o.kt)("h4",{id:"requirements"},"Requirements"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/"},"Snowplow Javascript tracker")," version 2 or later implemented."),(0,o.kt)("li",{parentName:"ul"},"Web Page context ",(0,o.kt)("a",{parentName:"li",href:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v2/tracker-setup/initializing-a-tracker-2/#webPage_context"},"enabled")," (enabled by default in ",(0,o.kt)("a",{parentName:"li",href:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracker-setup/initialization-options/#webPage_context"},"v3+"),")."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracking-events/#page-views"},"Page view events")," implemented.")),(0,o.kt)("h4",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/dbt-labs/dbt"},"dbt"),"\xa0must be installed."),(0,o.kt)("li",{parentName:"ul"},"A dataset of web events from the\xa0",(0,o.kt)("a",{parentName:"li",href:"/docs/collecting-data/collecting-from-own-applications/javascript-trackers/"},"Snowplow Javascript tracker"),"\xa0must be available in the database.")),(0,o.kt)("h4",{id:"supported-warehouses"},"Supported Warehouses"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Redshift, Snowflake, BigQuery and PostgreSQL")),(0,o.kt)("h4",{id:"installing-the-package"},"Installing the package"),(0,o.kt)("p",null,"Add the snowplow-web package to your ",(0,o.kt)("inlineCode",{parentName:"p"},"packages.yml")," file. For more information refer to dbt's ",(0,o.kt)("a",{parentName:"p",href:"https://hub.getdbt.com/snowplow/snowplow_web/latest/"},"package hub"),"."),(0,o.kt)("h4",{id:"essential-configuration"},"Essential Configuration"),(0,o.kt)("h5",{id:"1---check-source-data"},"1 - Check source data"),(0,o.kt)("p",null,"This package will by default assume your Snowplow events data is contained in the\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"atomic"),"\xa0schema of your\xa0",(0,o.kt)("a",{parentName:"p",href:"https://docs.getdbt.com/docs/running-a-dbt-project/using-the-command-line-interface/configure-your-profile"},"target.database"),". In order to change this, please add the following to your\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"dbt_project.yml"),"\xa0file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# dbt_project.yml\n...\nvars:\n  snowplow_web:\n    snowplow__atomic_schema: schema_with_snowplow_events\n    snowplow__database: database_with_snowplow_events\n")),(0,o.kt)("h5",{id:"2---enabled-desired-contexts"},"2 - Enabled desired contexts"),(0,o.kt)("p",null,"The web package has the option to join in data from the following 3 Snowplow enrichments:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/iab-enrichment/"},"IAB enrichment")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/ua-parser-enrichment/"},"UA Parser enrichment")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/enriching-your-data/available-enrichments/yauaa-enrichment/"},"YAUAA enrichment"))),(0,o.kt)("p",null,"By default these are\xa0",(0,o.kt)("strong",{parentName:"p"},"all disabled"),"\xa0in the web package. Assuming you have the enrichments turned on in your Snowplow pipeline, to enable the contexts within the package please add the following to your\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"dbt_project.yml"),"\xa0file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# dbt_project.yml\n...\nvars:\n  snowplow_web:\n    snowplow__enable_iab: true\n    snowplow__enable_ua: true\n    snowplow__enable_yauaa: true\n")),(0,o.kt)("h5",{id:"3---filter-your-data-set"},"3 - Filter your data set"),(0,o.kt)("p",null,"You can specify both\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"start_date"),"\xa0at which to start processing events and the\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"app_id"),"'s to filter for. By default the\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"start_date"),"\xa0is set to\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"2020-01-01"),"\xa0and all\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"app_id"),"'s are selected. To change this please add the following to your\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"dbt_project.yml"),"\xa0file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# dbt_project.yml\n...\nvars:\n  snowplow_web:\n    snowplow__start_date: 'yyyy-mm-dd'\n    snowplow__app_id: ['my_app_1','my_app_2']\n")),(0,o.kt)("h5",{id:"4---verify-page-ping-variables"},"4 - Verify page ping variables"),(0,o.kt)("p",null,"The web package processes page ping events to calculate web page engagement times. If your\xa0","[tracker configuration]","(",(0,o.kt)("a",{parentName:"p",href:"https://snowplow.github.io/dbt-snowplow-web/(/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracking-events/index.md#activity-tracking-page-pings)"},"https://snowplow.github.io/dbt-snowplow-web/(/docs/collecting-data/collecting-from-own-applications/javascript-trackers/javascript-tracker/javascript-tracker-v3/tracking-events/index.md#activity-tracking-page-pings)")," for\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"min_visit_length"),"\xa0(default 5) and\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"heartbeat"),"\xa0(default 10) differs from the defaults provided in this package, you can override by adding to your\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"dbt_project.yml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# dbt_project.yml\n...\nvars:\n  snowplow_web:\n    snowplow__min_visit_length: 5 # Default value\n    snowplow__heartbeat: 10 # Default value\n")),(0,o.kt)("h4",{id:"further-configuration"},(0,o.kt)("a",{parentName:"h4",href:"https://github.com/snowplow/data-models/tree/feature-redshift-web-v1/web/v1/redshift#configuration"}),"Further configuration"),(0,o.kt)("p",null,"There are many additional configurations you can make to the model such as changing destination schemas, disabling modules and removing bot traffic."),(0,o.kt)("p",null,"For more details please refer to the ",(0,o.kt)("a",{parentName:"p",href:"https://snowplow.github.io/dbt-snowplow-web/#!/overview/snowplow_web"},"snowplow-web package documentation"),"."),(0,o.kt)("h4",{id:"operation"},"Operation"),(0,o.kt)("p",null,"The Snowplow web model is designed to be run as a whole, which ensures all incremental tables are kept in sync. As such, we suggest running the model using:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"dbt run --models snowplow_web tag:snowplow_web_incremental\n")),(0,o.kt)("p",null,"We strongly advise reading the operation section on the ",(0,o.kt)("a",{parentName:"p",href:"https://snowplow.github.io/dbt-snowplow-web/#!/overview/snowplow_web"},"full doc site")," for more information on operations such as full-refreshes of the web model and backfilling data, since operations such as full refreshes deviate slightly from the native dbt implementation."),(0,o.kt)("h4",{id:"testing"},"Testing"),(0,o.kt)("p",null,"A full suite of tests are included within the package to ensure data quality. For more information on these and suggested implementations when running in orchestration please refer to the ",(0,o.kt)("a",{parentName:"p",href:"https://snowplow.github.io/dbt-snowplow-web/#!/overview/snowplow_web"},"doc site"),"."),(0,o.kt)("h2",{id:"customizing-the-web-model"},"Customizing the web model"),(0,o.kt)("p",null,"The package is designed in a modular manner, allowing you to easily add in your own custom SQL as well incorporate data from events outside of page views and page pings."),(0,o.kt)("p",null,"For more information on customizing the model please refer to the ",(0,o.kt)("a",{parentName:"p",href:"https://snowplow.github.io/dbt-snowplow-web/#!/overview/snowplow_web"},"full doc site"),". A dummy example of dbt project with customisations applied can also be found in the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/snowplow/dbt-snowplow-web/tree/main/custom_example"},"package repo"),"."))}c.isMDXComponent=!0}}]);